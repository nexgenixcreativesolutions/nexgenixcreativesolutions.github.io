<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nex Genix | Login & Signup</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">

  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Background gradient */
    body {
      background: radial-gradient(circle at top, #0f172a, #000);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
    }

    /* Glass card style */
    .glass-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 1rem;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
      width: 100%;
      max-width: 400px;
      padding: 2rem;
    }

    /* Input styling */
    .glass-input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 0.5rem;
      background: rgba(255,255,255,0.05);
      color: white;
      outline: none;
      transition: border 0.2s;
    }

    .glass-input:focus {
      border-color: #48bb78;
      background: rgba(255,255,255,0.1);
    }

    /* Button styling */
    .glass-button {
      width: 100%;
      padding: 0.75rem;
      margin-top: 1rem;
      border-radius: 0.5rem;
      font-weight: 600;
      background-color: #48bb78;
      color: white;
      transition: background 0.2s;
    }

    .glass-button:hover {
      background-color: #22c55e;
    }

    /* Text links */
    .link-button {
      cursor: pointer;
      color: #facc15;
      transition: color 0.2s;
    }

    .link-button:hover {
      color: #fde68a;
    }

    #msg {
      word-break: break-word;
    }
  </style>
</head>

<body>

<div class="glass-card">

  <!-- LOGO -->
  <div class="flex justify-center mb-4">
    <img src="assets/images/dashboard-logo-no-bg.png" alt="Nex Genix" class="h-12">
  </div>

  <h2 id="title" class="text-xl font-bold text-center mb-4">Sign In</h2>

  <!-- AUTH FORM -->
  <form id="authForm" class="space-y-3">
    <input id="email" type="email" placeholder="Email" class="glass-input" required>
    <input id="password" type="password" placeholder="Password" class="glass-input" required>
    <input id="fullname" type="text" placeholder="Full Name (for signup)" class="glass-input hidden">
    <button type="submit" class="glass-button">Continue</button>
  </form>

  <p id="msg" class="text-center text-sm mt-3 text-red-400"></p>

  <!-- TOGGLE SIGNUP/SIGNIN -->
  <div class="text-center mt-4 text-sm">
    <span id="toggleText">New here?</span>
    <button id="toggleBtn" class="link-button ml-1">Create account</button>
  </div>

  <!-- FORGOT PASSWORD -->
  <div class="text-center mt-2 text-sm">
    <button id="forgotBtn" class="text-gray-400 underline">Forgot password?</button>
  </div>

</div>

<script>
/* =========================
   ðŸ” SUPABASE SETUP
========================= */
const SUPABASE_URL = "https://rranivozhrsldhapzwqc.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_bdfuminbwIZn_S1DPfB7bg_ogP5mUVi";
const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

/* =========================
   ðŸ” MODE TOGGLE
========================= */
let isSignup = false;
const title = document.getElementById("title");
const fullnameInput = document.getElementById("fullname");
const toggleText = document.getElementById("toggleText");
const toggleBtn = document.getElementById("toggleBtn");
const msg = document.getElementById("msg");

toggleBtn.addEventListener("click", () => {
  isSignup = !isSignup;
  fullnameInput.classList.toggle("hidden");

  if (isSignup) {
    title.textContent = "Sign Up";
    toggleText.textContent = "Already have an account?";
    toggleBtn.textContent = "Sign in";
  } else {
    title.textContent = "Sign In";
    toggleText.textContent = "New here?";
    toggleBtn.textContent = "Create account";
  }

  msg.textContent = "";
});

/* =========================
   ðŸ” AUTH HANDLER
========================= */
document.getElementById("authForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();
  const fullName = fullnameInput.value.trim();

  msg.textContent = "";

  try {
    if (isSignup) {
      const { data, error } = await supabaseClient.auth.signUp({
        email,
        password,
        options: { emailRedirectTo: "https://nexgenixcreativesolutions.github.io/dashboard" }
      });

      if (error) throw error;
      if (!data.user) { msg.textContent = "Check your email to confirm your account."; return; }

      msg.textContent = "Account created! Check your email to confirm.";
      isSignup = false;
      fullnameInput.classList.add("hidden");
      title.textContent = "Sign In";
      toggleText.textContent = "New here?";
      toggleBtn.textContent = "Create account";
      return;
    }

    const { error } = await supabaseClient.auth.signInWithPassword({ email, password });
    if (error) throw error;

    window.location.href = "/dashboard";

  } catch (err) {
    msg.textContent = err.message || "Something went wrong";
  }
});

/* =========================
   ðŸ”‘ FORGOT PASSWORD
========================= */
document.getElementById("forgotBtn").addEventListener("click", async () => {
  const email = document.getElementById("email").value.trim();
  if (!email) { alert("Please enter your email first."); return; }

  const { error } = await supabaseClient.auth.resetPasswordForEmail(email, {
    redirectTo: "https://nexgenixcreativesolutions.github.io"
  });

  if (error) { alert(error.message); return; }
  alert("Password reset email sent.");
});
</script>

</body>
</html>
